Helm
====

helm delete sccstore 

helm install  sccstore sccstore-charts --set ui.image.tag=$(./getLatestTag sccstore-ui) --set pconstraints.image.tag=$(./getLatestTag sccstore-pconstraints) --set qserverless.image.tag=$(./getLatestTag sccstore-qserverless) 
--> then
helm upgrade  sccstore sccstore-charts --set ui.image.tag=$(./getLatestTag sccstore-ui) --set pconstraints.image.tag=$(./getLatestTag sccstore-pconstraints) --set qserverless.image.tag=$(./getLatestTag sccstore-qserverless) 

append "--dry-run --debug" for test-only
for using the postgres database on the win10 VM, add:  "--set global.database.service=win10-postgresql"


OpenShift Management
====================
oc adm drain host05.rhlab.ch --ignore-daemonsets --force --grace-period=30 --delete-emptydir-data
oc adm uncordon host05.rhlab.ch


Postgresql
==========

in postgresql.conf change:

    listen_addresses = '*'

in pg_hba.conf add:

    host    all             all              0.0.0.0/0                       md5


List databases:     \l
create database:    CREATE DATABASE sccstore;
create user:        CREATE USER sccstore WITH PASSWORD 'sccstore';
                    grant all privileges on database sccstore to sccstore;
show tables:        \dt
change to database: \c sccstore;
create table:       create table complaints (compl_id SERIAL PRIMARY KEY, complaint VARCHAR (255) NOT NULL);


kubectl run psqlclient --image=tmaier/postgresql-client --env="PGPASSWORD=sccstore"  --command -- /bin/sh -c 'tail -f /dev/null'

psql  -h win10-postgresql -U sccstore -d sccstore -W


Serverless REST API
===================
curl -X GET --insecure https://sccstore-qserverless-dpiol-test1.apps.ocp001.rhlab.ch/complaints

curl -d "compl=example inserted via REST API" -X POST --insecure https://sccstore-qserverless-dpiol-test1.apps.ocp001.rhlab.ch/complaint

curl -d "id=6" -X DELETE --insecure https://sccstore-qserverless-dpiol-test1.apps.ocp001.rhlab.ch/complaint
